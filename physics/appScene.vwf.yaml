--- 
extends: http://vwf.example.com/types/glge
properties:
  createCube: true
  cubesCreated: 0
  spheresCreated: 0
scripts:
- text: |
    var lastTimeObjWasCreated;
    var mouseIsDown = false;
    var mouseDownTime = -1;
    var idsToAddVelocity;
    var cube = { 
      "source": "Cube", 
      "extends": "http://vwf.example.com/types/node3",
      "type": "text/xml",
      "properties": { 
        "material": [ "red", "blue", "yellow" ],
        "scale": [ 1.5, 1.5, 1.5 ], 
        "eulers": [ 0, 0, 0 ], 
        "rotVelocityDamping": [ 0.5, 0.5, 0.5 ], 
        "physics": [ "box", 3.0, 3.0, 3.0 ], 
        "friction": 0.5, 
        "mass": 400, 
        "position": [ 0, 0, 0 ], 
        "linVelocityDamping": [ 1, 1, 1, 0 ], 
        "restitution": 0.10, 
        "velocity": [ 0, 0, 0 ], 
        } 
      };
    var sphere = { 
      "source": "Sphere", 
      "extends": "http://vwf.example.com/types/node3",
      "type": "text/xml",
      "properties": { 
        "material": [ "red", "blue", "yellow" ], 
        "scale": [ 2.0, 2.0, 2.0 ], 
        "eulers": [ 0, 0, 0 ], 
        "rotVelocityDamping": [ 0.5, 0.5, 0.5 ], 
        "physics": [ "sphere", 2.0 ], 
        "friction": 0.5, 
        "mass": 100, 
        "position": [ 0, 0, 0 ], 
        "linVelocityDamping": [ 1, 1, 1, 0 ], 
        "restitution": 0.10, 
        "velocity": [ 0, 0, 0 ], 
        } 
      };
    this.mouseDown = function( parms ) {
      mouseIsDown = true;
      mouseDownTime = new Date().getTime();
      if ( this.__proto__ && this.__proto__.__proto__ && this.__proto__.__proto__.mouseDown ) {
        this.__proto__.__proto__.mouseDown.call( this, parms );  
      }     
    }
    this.mouseUp = function( parms ) {
      mouseIsDown = false;
      var now = new Date().getTime();
      //if ( now - mouseDownTime < 600 ) {
        this.createObject( parms );
      //}
      if ( this.__proto__ && this.__proto__.__proto__ && this.__proto__.__proto__.mouseUp ) {
        this.__proto__.__proto__.mouseUp.call( this, parms );  
      }
      mouseDownTime = -1;
    }
    this.createObject = function( parms ) {
      var newObjName;
      if ( this.createCube ) {
        this.cubesCreated = this.cubesCreated + 1;
        newObjName = "cube" + this.cubesCreated;
        
        cube.properties.position = [ parms.camPos[0], parms.camPos[1], parms.camPos[2] ];
        cube.properties.velocity = [ parms.trans[0] * 60, parms.trans[1] * 60, parms.trans[2] * 60];
        
        vwf.createNode( "index-vwf", cube, newObjName, undefined );        
        this.createCube = false;
      } else {
        this.spheresCreated = this.spheresCreated + 1;
        newObjName = "sphere" + this.spheresCreated;
        
        sphere.properties.position = [ parms.camPos[0], parms.camPos[1], parms.camPos[2] ];
        sphere.properties.velocity = [ parms.trans[0] * 60, parms.trans[1] * 60, parms.trans[2] * 60 ];
        
        vwf.createNode( "index-vwf", sphere, newObjName, undefined );
        this.createCube = true;      
      }
    }

  type: application/javascript    