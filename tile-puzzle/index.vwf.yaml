--- 
extends: appscene.vwf
source: index.xml
type: model/x-glge
properties:
  tilePosition1: [  16.5, -33, 0 ]
  tilePosition2: [   5.5, -33, 0 ]
  tilePosition3: [  -5.5, -33, 0 ]
  tilePosition4: [ -16.5, -33, 0 ]
  tilePosition5: [  16.5, -22, 0 ]
  tilePosition6: [   5.5, -22, 0 ]
  tilePosition7: [  -5.5, -22, 0 ]
  tilePosition8: [ -16.5, -22, 0 ]
  tilePosition9: [  16.5, -11, 0 ]
  tilePosition10: [  5.5, -11, 0 ]
  tilePosition11: [  -5.5, -11, 0 ]
  tilePosition12: [ -16.5, -11, 0 ]
  tilePosition13: [  16.5,   0, 0 ]
  tilePosition14: [   5.5,   0, 0 ]
  tilePosition15: [  -5.5,   0, 0 ]
  tilePosition16: [ -16.5,   0, 0 ]
  openTilePosition: [ -16.5, 0, 0 ]
  tileDistance: 12
methods:
  setPositions: 
children: 
  shuffleBtn: 
    extends: http://vwf.example.com/types/node3
    source: shuffleBtn.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 7.2, 10, 0 ]
      eulers: [90, 0, 180]
      scale: [ 3, 3, 3 ]
    methods:
      rotate: 
        var orientation = this.eulers;
        this.eulers = [ orientation[0] + 2, orientation[1], orientation[2] ];
        this.future( 0.1 ).rotate();
    scripts:
    - text: |
        this.initialize = function() {
          this.position = this.position;
          this.eulers = this.eulers;
          this.scale = this.scale;
          this.rotate();
        }
        this.pointerClick = function() {
          this.parent.shuffle();
        }
      type: application/javascript
    children:
      ShuffleCubeMaterial1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      ShuffleTextMaterial1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""  
  solveBtn: 
    extends: http://vwf.example.com/types/node3
    source: solveBtn.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ -7.2, 10, 0 ]
      eulers: [90, 0, 180]
      scale: [ 3, 3, 3 ]
    scripts:
    - text: |
        this.initialize = function() {
          this.position = this.position;
          this.eulers = this.eulers;
          this.scale = this.scale;
          this.future( 10 ).position = [ -7.2, 10, 2 ];
        }
        this.pointerClick = function() {
          this.parent.solve();
        }
      type: application/javascript
    children:
      SolveCubeMaterial1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      SolveTextMaterial1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""  
  tile1: 
    extends: http://vwf.example.com/types/node3
    source: tile01.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this);        	
        }
      type: application/javascript
    children:
      Cube01Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text01Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""        
  tile2: 
    extends: http://vwf.example.com/types/node3
    source: tile02.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this);        	
        }
      type: application/javascript
    children:
      Cube02Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text02Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""  
  tile3: 
    extends: http://vwf.example.com/types/node3
    source: tile03.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this);        	
        }
      type: application/javascript
    children:
      Cube03Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text03Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""        
  tile4: 
    extends: http://vwf.example.com/types/node3
    source: tile04.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this);        	
        }
      type: application/javascript
    children:
      Cube04Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text04Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: "" 
  tile5: 
    extends: http://vwf.example.com/types/node3
    source: tile05.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this);         	
        }
      type: application/javascript
    children:
      Cube05Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text05Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
  tile6: 
    extends: http://vwf.example.com/types/node3
    source: tile06.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this);         	
        }
      type: application/javascript
    children:
      Cube06Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text06Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
  tile7: 
    extends: http://vwf.example.com/types/node3
    source: tile07.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this);         	
        }
      type: application/javascript
    children:
      Cube07Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text07Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
  tile8: 
    extends: http://vwf.example.com/types/node3
    source: tile08.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube08Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text08Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
  tile9: 
    extends: http://vwf.example.com/types/node3
    source: tile09.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube09Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text09Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
  tile10: 
    extends: http://vwf.example.com/types/node3
    source: tile10.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube10Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text10_1Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text10_2Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
  tile11: 
    extends: http://vwf.example.com/types/node3
    source: tile11.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube11Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text11_1Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text11_2Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
  tile12: 
    extends: http://vwf.example.com/types/node3
    source: tile12.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube12Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text12_1Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text12_2Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""      
  tile13: 
    extends: http://vwf.example.com/types/node3
    source: tile13.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube13Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text13_1Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text13_2Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""        
  tile14: 
    extends: http://vwf.example.com/types/node3
    source: tile14.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube14Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text14_1Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text14_2Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""  
  tile15: 
    extends: http://vwf.example.com/types/node3
    source: tile15.dae
    type: model/vnd.collada+xml
    properties: 
      position: [ 0, 0, 0 ]
      scale: [ 0.05, 0.05, 0.05 ]
    scripts:
    - text: |
        this.pointerClick = function() {
          this.parent.moveTile(this); 	
        }
      type: application/javascript
    children:
      Cube15Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text15_1Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""
      Text15_2Material1:
        extends: http://vwf.example.com/types/material
        properties:
          texture: ""      
scripts:
- text: |
    this.initialize = function() {
      this.tile1.scale = this.tile1.scale;
      this.tile2.scale = this.tile2.scale;
      this.tile3.scale = this.tile3.scale;
      this.tile4.scale = this.tile4.scale;
      this.tile5.scale = this.tile5.scale;
      this.tile6.scale = this.tile6.scale;
      this.tile7.scale = this.tile7.scale;
      this.tile8.scale = this.tile8.scale;
      this.tile9.scale = this.tile9.scale;
      this.tile10.scale = this.tile10.scale;
      this.tile11.scale = this.tile11.scale;
      this.tile12.scale = this.tile12.scale;
      this.tile13.scale = this.tile13.scale;
      this.tile14.scale = this.tile14.scale;
      this.tile15.scale = this.tile15.scale;
    
      this.tile1.position = this.tilePosition1;
      this.tile2.position = this.tilePosition2;
      this.tile3.position = this.tilePosition3;
      this.tile4.position = this.tilePosition4;
      this.tile5.position = this.tilePosition5;
      this.tile6.position = this.tilePosition6;
      this.tile7.position = this.tilePosition7;
      this.tile8.position = this.tilePosition8;
      this.tile9.position = this.tilePosition9;
      this.tile10.position = this.tilePosition10;
      this.tile11.position = this.tilePosition11;
      this.tile12.position = this.tilePosition12;
      this.tile13.position = this.tilePosition13;
      this.tile14.position = this.tilePosition14;
      this.tile15.position = this.tilePosition15;
      this.openTilePosition = this.tilePosition16;
      
      this.tile1.Text01Material1.texture = "images/dkBlue.png";
      this.tile2.Text02Material1.texture = "images/dkBlue.png";
      this.tile3.Text03Material1.texture = "images/dkBlue.png";
      this.tile4.Text04Material1.texture = "images/dkBlue.png";
      this.tile5.Text05Material1.texture = "images/dkBlue.png";
      this.tile6.Text06Material1.texture = "images/dkBlue.png";
      this.tile7.Text07Material1.texture = "images/dkBlue.png";
      this.tile8.Text08Material1.texture = "images/dkBlue.png";
      this.tile9.Text09Material1.texture = "images/dkBlue.png";
      this.tile10.Text10_1Material1.texture = "images/dkBlue.png";
      this.tile10.Text10_2Material1.texture = "images/dkBlue.png";
      this.tile11.Text11_1Material1.texture = "images/dkBlue.png";
      this.tile11.Text11_2Material1.texture = "images/dkBlue.png";
      this.tile12.Text12_1Material1.texture = "images/dkBlue.png";
      this.tile12.Text12_2Material1.texture = "images/dkBlue.png";
      this.tile13.Text13_1Material1.texture = "images/dkBlue.png";
      this.tile13.Text13_2Material1.texture = "images/dkBlue.png";
      this.tile14.Text14_1Material1.texture = "images/dkBlue.png";
      this.tile14.Text14_2Material1.texture = "images/dkBlue.png";
      this.tile15.Text15_1Material1.texture = "images/dkBlue.png";
      this.tile15.Text15_2Material1.texture = "images/dkBlue.png";
      
      this.tile1.Cube01Material1.texture = "images/ltBlue.png";
      this.tile2.Cube02Material1.texture = "images/ltBlue.png";
      this.tile3.Cube03Material1.texture = "images/ltBlue.png";
      this.tile4.Cube04Material1.texture = "images/ltBlue.png";
      this.tile5.Cube05Material1.texture = "images/ltBlue.png";
      this.tile6.Cube06Material1.texture = "images/ltBlue.png";
      this.tile7.Cube07Material1.texture = "images/ltBlue.png";
      this.tile8.Cube08Material1.texture = "images/ltBlue.png";
      this.tile9.Cube09Material1.texture = "images/ltBlue.png";
      this.tile10.Cube10Material1.texture = "images/ltBlue.png";
      this.tile11.Cube11Material1.texture = "images/ltBlue.png";
      this.tile12.Cube12Material1.texture = "images/ltBlue.png";
      this.tile13.Cube13Material1.texture = "images/ltBlue.png";
      this.tile14.Cube14Material1.texture = "images/ltBlue.png";
      this.tile15.Cube15Material1.texture = "images/ltBlue.png";
      
      this.shuffleBtn.ShuffleCubeMaterial1.texture = "images/red.png";
      this.shuffleBtn.ShuffleTextMaterial1.texture = "images/black.png";
      this.solveBtn.SolveCubeMaterial1.texture = "images/green.png";
      this.solveBtn.SolveTextMaterial1.texture = "images/black.png";
     
    }
    
    this.shuffle = function() {
      tilePositions = [this.tilePosition1, this.tilePosition2, this.tilePosition3, this.tilePosition4, 
                       this.tilePosition5, this.tilePosition6, this.tilePosition7, this.tilePosition8, 
                       this.tilePosition9, this.tilePosition10, this.tilePosition11, this.tilePosition12, 
                       this.tilePosition13, this.tilePosition14, this.tilePosition15, this.tilePosition16];
      tilePositions.sort(function() { return (Math.round(Math.random())-0.5); }); 
      // this.setPositions(tilePositions);
      vwf.send(this.id, "callMethod", "setPositions", tilePositions);
    }
    
    this.solve = function() {
      this.tile1.position = this.tilePosition1;
      this.tile2.position = this.tilePosition2;
      this.tile3.position = this.tilePosition3;
      this.tile4.position = this.tilePosition4;
      this.tile5.position = this.tilePosition5;
      this.tile6.position = this.tilePosition6;
      this.tile7.position = this.tilePosition7;
      this.tile8.position = this.tilePosition8;
      this.tile9.position = this.tilePosition9;
      this.tile10.position = this.tilePosition10;
      this.tile11.position = this.tilePosition11;
      this.tile12.position = this.tilePosition12;
      this.tile13.position = this.tilePosition13;
      this.tile14.position = this.tilePosition14;
      this.tile15.position = this.tilePosition15;
      this.openTilePosition = this.tilePosition16;
    }
    
    this.setPositions = function(tilePositions) {
      if (vwf.time() >= (this.lastSetPositionTime || 0) + 0.1) {
        this.lastSetPositionTime = vwf.time();
        this.tile1.position = tilePositions[0];
        this.tile2.position = tilePositions[1];
        this.tile3.position = tilePositions[2];
        this.tile4.position = tilePositions[3];
        this.tile5.position = tilePositions[4];
        this.tile6.position = tilePositions[5];
        this.tile7.position = tilePositions[6];
        this.tile8.position = tilePositions[7];
        this.tile9.position = tilePositions[8];
        this.tile10.position = tilePositions[9];
        this.tile11.position = tilePositions[10];
        this.tile12.position = tilePositions[11];
        this.tile13.position = tilePositions[12];
        this.tile14.position = tilePositions[13];
        this.tile15.position = tilePositions[14];
        this.openTilePosition = tilePositions[15];
      }
    }

    this.moveTile = function(obj) {
      dx = Math.abs(obj.position[0] - this.openTilePosition[0]);
      dy = Math.abs(obj.position[1] - this.openTilePosition[1]);
      if((dx < this.tileDistance && dy == 0) ||
         (dy < this.tileDistance && dx == 0))
      {
        currentPosition = obj.position;
        obj.position = this.openTilePosition;
        this.openTilePosition = currentPosition;
      }           	
    }
  type: application/javascript
